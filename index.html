<!DOCTYPE html>
<html class="dark" lang="es">

<head>
    <!-- Manifest PWA -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#137fec">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="FinanzApp">
    <link rel="apple-touch-icon" href="/icons/icon-192x192.png">

    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>FinanzApp - Registro R√°pido</title>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet" />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#137fec",
                        "background-light": "#f6f7f8",
                        "background-dark": "#101922",
                        "surface-dark": "#1c242c",
                        "surface-input": "#242e38",
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.25rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "2xl": "1rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>

    <!-- Estilos personalizados -->
    <link rel="stylesheet" href="/styles.css">
</head>

<body
    class="bg-background-light dark:bg-background-dark font-display antialiased overflow-hidden h-screen flex flex-col relative text-slate-900 dark:text-white">
    <!-- Verificar autenticaci√≥n -->
    <script>
        // Verificar si el usuario est√° logueado
        const authToken = localStorage.getItem('authToken');
        if (!authToken) {
            window.location.href = '/login.html';
        }
    </script>
    <!-- Top App Bar -->
    <header class="flex items-center justify-between px-4 py-4 pt-6 bg-background-light dark:bg-background-dark z-10 shrink-0">
        <button onclick="handleLogout()" class="flex w-16 items-center justify-start text-slate-500 dark:text-[#9dabb9] active:opacity-70">
            <span class="material-symbols-outlined">logout</span>
        </button>
        <h2 class="text-slate-900 dark:text-white text-lg font-bold leading-tight tracking-[-0.015em] text-center flex-1">
            Nueva Transacci√≥n
        </h2>
        <div class="w-16"></div>
    </header>

    <!-- Main Content Scroll Area -->
    <main class="flex-1 overflow-y-auto no-scrollbar pb-32">
        <div class="flex flex-col gap-6 px-5 pt-2">

            <!-- Transaction Type Toggle -->
            <div class="w-full">
                <div class="flex h-12 w-full items-center justify-center rounded-xl bg-slate-200 dark:bg-[#283039] p-1">
                    <label
                        class="flex cursor-pointer h-full grow items-center justify-center overflow-hidden rounded-lg px-2 has-[:checked]:bg-white dark:has-[:checked]:bg-[#111418] has-[:checked]:shadow-sm text-slate-500 dark:text-[#9dabb9] dark:has-[:checked]:text-white text-sm font-semibold transition-all">
                        <span class="truncate">Gasto</span>
                        <input checked class="invisible w-0 absolute" name="transaction-type" type="radio"
                            value="Gasto" />
                    </label>
                    <label
                        class="flex cursor-pointer h-full grow items-center justify-center overflow-hidden rounded-lg px-2 has-[:checked]:bg-white dark:has-[:checked]:bg-[#111418] has-[:checked]:shadow-sm text-slate-500 dark:text-[#9dabb9] dark:has-[:checked]:text-white text-sm font-semibold transition-all">
                        <span class="truncate">Ingreso</span>
                        <input class="invisible w-0 absolute" name="transaction-type" type="radio" value="Ingreso" />
                    </label>
                </div>
            </div>

            <!-- Concept Input -->
            <div class="space-y-2">
                <label class="text-sm font-medium text-slate-500 dark:text-[#9dabb9] ml-1">Concepto</label>
                <div class="relative flex items-center">
                    <span
                        class="material-symbols-outlined absolute left-4 text-slate-400 dark:text-[#586472]">edit</span>
                    <input id="concept"
                        class="w-full rounded-2xl bg-white dark:bg-surface-input border-0 py-4 pl-12 pr-4 text-base text-slate-900 dark:text-white placeholder:text-slate-400 dark:placeholder:text-[#586472] focus:ring-2 focus:ring-primary focus:outline-none transition-shadow shadow-sm"
                        placeholder="Ej: Supermercado, Netflix, Salario" type="text" />
                </div>
            </div>

            <!-- Big Amount Input -->
            <div class="py-4 flex flex-col items-center justify-center space-y-3">
                <div class="flex items-center justify-center space-x-2">
                    <!-- Currency Selector -->
                    <div class="relative group">
                        <select id="currency"
                            class="currency appearance-none bg-slate-200 dark:bg-[#283039] text-slate-900 dark:text-white font-bold text-sm py-2 pl-3 pr-8 rounded-full border-0 focus:ring-0 cursor-pointer">
                            <option value="EUR">EUR ‚Ç¨</option>
                            <option value="USD">USD $</option>
                        </select>
                        <span
                            class="material-symbols-outlined absolute right-2 top-1/2 -translate-y-1/2 text-sm pointer-events-none text-slate-500 dark:text-[#9dabb9]">expand_more</span>
                    </div>
                </div>
                <!-- Huge Input -->
                <div class="relative w-full text-center">
                    <input id="amount"
                        class="w-full bg-transparent border-0 p-0 text-center text-6xl font-extrabold tracking-tighter text-slate-900 dark:text-white placeholder:text-slate-300 dark:placeholder:text-[#3b4754] focus:ring-0 focus:outline-none"
                        inputmode="decimal" placeholder="0,00" type="number" step="0.01" />
                </div>
            </div>

            <!-- Category & Date Section -->
            <div class="grid grid-cols-1 gap-4">
                <!-- Category Dropdown -->
                <div class="space-y-2">
                    <label class="text-sm font-medium text-slate-500 dark:text-[#9dabb9] ml-1">Categor√≠a</label>
                    <div class="relative">
                        <select id="category"
                            class="w-full appearance-none rounded-2xl bg-white dark:bg-surface-input border-0 py-4 pl-4 pr-10 text-base text-slate-900 dark:text-white focus:ring-2 focus:ring-primary focus:outline-none shadow-sm">
                            <option disabled selected value="">Seleccionar categor√≠a</option>
                            <option value="ocio">üéÆ Ocio</option>
                            <option value="servicios">üí° Servicios</option>
                            <option value="hogar">üè† Hogar</option>
                            <option value="salud">‚ù§Ô∏è Salud</option>
                            <option value="transporte">üöå Transporte</option>
                            <option value="educacion">üìö Educaci√≥n</option>
                            <option value="comida">üçî Comida</option>
                            <option value="otros">üì¶ Otros</option>
                        </select>
                        <span
                            class="material-symbols-outlined absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-slate-400 dark:text-[#586472]">expand_more</span>
                    </div>
                </div>

                <!-- Optional Fields Row -->
                <div class="flex gap-4">
                    <!-- Date Picker -->
                    <div class="space-y-2 flex-1">
                        <label class="text-sm font-medium text-slate-500 dark:text-[#9dabb9] ml-1">Fecha</label>
                        <div class="relative">
                            <input id="date"
                                class="w-full rounded-2xl bg-white dark:bg-surface-input border-0 py-4 px-4 text-base text-slate-900 dark:text-white focus:ring-2 focus:ring-primary focus:outline-none shadow-sm [color-scheme:light] dark:[color-scheme:dark]"
                                type="date" />
                        </div>
                    </div>
                    <!-- Subcategory (Optional) -->
                    <div class="space-y-2 flex-1">
                        <label class="text-sm font-medium text-slate-500 dark:text-[#9dabb9] ml-1">Subcategor√≠a</label>
                        <div class="relative">
                            <input id="subcategory"
                                class="w-full rounded-2xl bg-white dark:bg-surface-input border-0 py-4 px-4 text-base text-slate-900 dark:text-white placeholder:text-slate-400 dark:placeholder:text-[#586472] focus:ring-2 focus:ring-primary focus:outline-none shadow-sm"
                                placeholder="Opcional" type="text" />
                        </div>
                    </div>
                </div>
            </div>

            <!-- Extra space -->
            <div class="h-12"></div>
        </div>
    </main>

    <!-- Sticky Footer Action Button -->
    <div
        class="fixed bottom-0 left-0 w-full bg-gradient-to-t from-background-light via-background-light to-transparent dark:from-background-dark dark:via-background-dark pt-8 pb-8 px-5 z-20">
        <button
            class="w-full rounded-2xl bg-primary py-4 text-center text-white font-bold text-lg shadow-[0_4px_14px_0_rgba(19,127,236,0.39)] hover:bg-primary/90 active:scale-[0.98] transition-all flex items-center justify-center gap-2">
            <span class="material-symbols-outlined">check</span>
            Guardar Transacci√≥n
        </button>
    </div>

    <!-- JavaScript -->
    <script src="/app.js"></script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(reg => console.log('‚úÖ Service Worker registered'))
                    .catch(err => console.log('‚ùå SW registration failed', err));
            });
        }
    </script>
</body>

</html>